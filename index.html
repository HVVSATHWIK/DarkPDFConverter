<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Convert your PDF files to dark mode with LitasDark - the best PDF dark mode converter.">
    <title>PDF Dark Mode Converter - LitasDark</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="favi.png">

    <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.min.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.worker.min.js';
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js" defer></script>

</head>
<body>
    <div id="particles-js" class="animated-gradient-background"></div>
    <header>
        <h1>LitasDark: PDF Dark Mode Converter</h1>
        <img src="pdfdark.jpg" alt="LitasDark Logo" id="logo">
    </header>
    <main>
        <section>
            <div class="form-group">
                <label for="pdfUpload">Upload PDF:</label>
                <input type="file" id="pdfUpload" accept="application/pdf" aria-label="Upload PDF">
            </div>
        </section>
        <section id="themeSettings" role="region" aria-labelledby="themeSettingsLabel">
            <h2 id="themeSettingsLabel">Theme Settings</h2>
            <div class="form-group">
                <label for="themeSelect">Choose Theme:</label>
                <select id="themeSelect" aria-label="Theme Selection">
                    <option value="dark">Dark</option>
                    <option value="darker">Darker</option>
                    <option value="darkest">Darkest</option>
                </select>
            </div>
            <div class="form-group">
                <label for="brightness">Brightness:</label>
                <input type="range" id="brightness" min="50" max="150" value="100" aria-label="Brightness">
            </div>
            <div class="form-group">
                <label for="contrast">Contrast:</label>
                <input type="range" id="contrast" min="50" max="150" value="100" aria-label="Contrast">
            </div>
        </section>
        
        <section id="viewerControlsAndDownloadSection" style="grid-column: 1 / -1;"> 
            <div class="form-group">
                 <button id="generatePreviewButton">Generate Dark Mode Preview</button> 
            </div>
            <div class="form-group">
                <button id="convertButton">Convert to Dark Mode & Download</button> 
            </div>
            <div class="form-group">
                <a id="downloadLink" href="#" download="dark-mode.pdf" style="display: none;">Download Converted PDF</a>
            </div>
        </section>

        <!-- New Section for Side-by-Side Viewers and Sync Button -->
        <section id="pdfViewersMainSection" style="grid-column: 1 / -1;">
            <div class="form-group" style="text-align: center; margin-bottom: 15px;">
                <button id="syncScrollButton">Enable Scroll Sync</button>
            </div>
            <div class="pdf-viewers-wrapper"> 
                <section id="originalPdfViewerSection" class="viewer-column">
                    <h3>Original PDF Document</h3>
                    <!-- Thumbnails div removed -->
                    <div id="originalPdfPagesContainer" class="pdf-viewer-container" style="background-color: #f0f0f0;">
                        <!-- Canvases for original PDF pages will be appended here by JS -->
                    </div>
                </section>

                <section id="darkModePdfViewerSection" class="viewer-column" style="display: none;"> 
                    <h3>Dark Mode Preview</h3>
                    <div id="darkModePdfPagesContainer" class="pdf-viewer-container" style="background-color: #1a1a1a;">
                        <!-- Canvases for dark mode PDF pages will be appended here by JS -->
                    </div>
                </section>
            </div>
        </section>

        <section id="pdfActionsSection" style="grid-column: 1 / -1;">
            <div style="display:flex; flex-wrap:wrap; justify-content:space-around;"> 
                <div class="form-group" style="flex-basis: 45%;">
                    <label for="startPage">Start Page:</label>
                    <input type="number" id="startPage" min="1" aria-label="Start Page">
                </div>
                <div class="form-group" style="flex-basis: 45%;">
                    <label for="endPage">End Page:</label>
                    <input type="number" id="endPage" min="1" aria-label="End Page">
                </div>
                <div class="form-group" style="flex-basis: 100%; text-align:center;">
                    <button id="splitButton">Split PDF</button>
                    <a id="splitDownloadLink" href="#" download="split_pdf.pdf" style="display: none; margin-left:10px;">Download Split PDF</a>
                </div>
            </div>

            <div style="display:flex; flex-wrap:wrap; justify-content:space-around; margin-top:20px;">
                <div class="form-group" style="flex-basis: 100%;">
                    <label for="pdfFiles">Upload PDFs to Merge (select multiple):</label>
                    <input type="file" id="pdfFiles" accept="application/pdf" multiple aria-label="Upload PDFs">
                </div>
                <div class="form-group" style="flex-basis: 100%; text-align:center;">
                    <button id="mergeButton">Merge PDFs</button>
                    <a id="mergeDownloadLink" href="#" download="merged_pdf.pdf" style="display: none; margin-left:10px;">Download Merged PDF</a>
                </div>
            </div>

            <div style="display:flex; flex-wrap:wrap; justify-content:space-around; margin-top:20px;">
                <div class="form-group" style="flex-basis: 45%;">
                    <label for="rotatePageNumber">Page Number to Rotate:</label>
                    <input type="number" id="rotatePageNumber" min="1" aria-label="Page Number">
                </div>
                <div class="form-group" style="flex-basis: 45%;">
                    <label for="rotateAngle">Angle (e.g., 90, 180):</label>
                    <input type="number" id="rotateAngle" step="90" min="0" max="270" aria-label="Rotation Angle">
                </div>
                <div class="form-group" style="flex-basis: 100%; text-align:center;">
                    <button id="rotateButton">Rotate Page</button>
                    <a id="rotateDownloadLink" href="#" download="rotated_pdf.pdf" style="display: none; margin-left:10px;">Download Rotated PDF</a>
                </div>
            </div>
        </section>

        <div id="loading" class="hidden" role="status" aria-live="polite">
            <div class="spinner"></div>
            <p>Loading...</p>
        </div>
    </main>
    <footer>
        <p>&copy; 2024 LitasDark. All rights reserved.</p>
    </footer>
    <div id="messageContainer" class="message hidden" role="alert" aria-live="assertive"></div>
    <a href="#" id="backToTop" aria-label="Back to Top">â†‘</a>
    <script src="https://cdn.jsdelivr.net/npm/particles.js"></script>
    
    <script type="module" src="messages.js" defer></script>
    <script type="module" src="pdfProcessing.js" defer></script>
    <script type="module" src="script.js" defer></script>

    <script>
        particlesJS('particles-js', {
            particles: {
                number: { value: 150, density: { enable: true, value_area: 1000 } },
                color: {
                    value: ['#ffffff', '#ff0000', '#00ff00', '#0000ff']
                },
                shape: {
                    type: ['circle', 'triangle', 'polygon', 'star', 'edge'],
                    stroke: { width: 0, color: '#000000' },
                    polygon: { nb_sides: 6 },
                },
                opacity: {
                    value: 0.8,
                    random: true,
                    anim: { enable: true, speed: 2, opacity_min: 0.2, sync: false },
                },
                size: {
                    value: 5,
                    random: true,
                    anim: { enable: true, speed: 30, size_min: 0.1, sync: false },
                },
                line_linked: {
                    enable: true,
                    distance: 120,
                    color: '#ffffff',
                    opacity: 0.8,
                    width: 1,
                },
                move: {
                    enable: true,
                    speed: 10,
                    direction: 'none',
                    random: true,
                    straight: false,
                    out_mode: 'out',
                    bounce: true,
                    attract: { enable: true, rotateX: 800, rotateY: 1600 },
                },
            },
            interactivity: {
                detect_on: 'canvas',
                events: {
                    onhover: { enable: true, mode: ['grab', 'bubble', 'repulse'] },
                    onclick: { enable: true, mode: ['push', 'remove', 'bubble'] },
                    resize: true,
                },
                modes: {
                    grab: { distance: 350, line_linked: { opacity: 1 } },
                    bubble: { distance: 400, size: 20, duration: 2, opacity: 0.8, speed: 3 },
                    repulse: { distance: 250, duration: 0.6 },
                    push: { particles_nb: 4 },
                    remove: { particles_nb: 2 },
                },
            },
            retina_detect: true,
        });
    </script>
</body>
</html>